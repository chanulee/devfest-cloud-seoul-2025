# Go ADK ν•Έμ¦μ¨ Session 8: μ›κ²© μ—μ΄μ „νΈμ™€ A2A (Agent-to-Agent)

ν™μν•©λ‹λ‹¤! π‘‹ μ΄λ² μ„Έμ…μ—μ„λ” ADKμ κ°€μ¥ κ°•λ ¥ν• ν™•μ¥ κΈ°λ¥μΈ **A2A(Agent-to-Agent)** ν”„λ΅ν† μ½μ„ λ‹¤λ£Ήλ‹λ‹¤.

μ΄μ  μ—¬λ¬λ¶„μ μ—μ΄μ „νΈλ” λ΅μ»¬ μ»΄ν“¨ν„° μ•μ— κ°‡ν€ μμ§€ μ•μµλ‹λ‹¤. μΈν„°λ„·μ„ ν†µν•΄ λ‹¤λ¥Έ μ„λ²„μ— μλ” μ—μ΄μ „νΈμ—κ² "μ΄κ²ƒ μΆ€ κ³„μ‚°ν•΄μ¤"λΌκ³  μ”μ²­ν•κ³ , κ²°κ³Όλ¥Ό λ°›μ•„μ¬ μ μμµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ **μν•™ μ²μ¬ μ„λ²„**λ¥Ό λ”°λ΅ λ„μ›λ‘κ³ , **μ±„ν… λ΄‡**μ΄ ν•„μ”ν•  λ•λ§ κ°–λ‹¤ μ“°λ” κµ¬μ΅°λ¥Ό λ§λ“¤μ–΄ λ³΄κ² μµλ‹λ‹¤.

## π― ν•™μµ λ©ν‘
*   **Remote Agent Architecture**: μ—μ΄μ „νΈλ¥Ό μ›Ή μ„λ²„λ΅ λ„μ°λ” λ°©λ²• μ΄ν•΄ν•κΈ° (`web.Launcher`)
*   **A2A Protocol**: μ—μ΄μ „νΈλΌλ¦¬ μ„λ΅μ λ¥λ ¥(Agent Card)μ„ ν™•μΈν•κ³  ν†µμ‹ ν•λ” κ·μ•½ μ΄ν•΄ν•κΈ°
*   **Tool Expansion**: λ‹¨μΌ λ„κµ¬κ°€ μ•„λ‹ μ—¬λ¬ λ„κµ¬(μ†μ, ν©ν† λ¦¬μ–Ό, GCD)λ¥Ό νƒ‘μ¬ν• κ°•λ ¥ν• μ—μ΄μ „νΈ λ§λ“¤κΈ°

---

## π—οΈ μ•„ν‚¤ν…μ² κ°μ”

μ°λ¦¬λ” λ‘ κ°μ λ…λ¦½μ μΈ ν”„λ΅κ·Έλ¨μ„ μ‹¤ν–‰ν•  κ²ƒμ…λ‹λ‹¤.

1.  **Server (MathHelper)**: 8001λ² ν¬νΈμ—μ„ λ€κΈ°ν•λ©°, λ³µμ΅ν• μν•™ κ³„μ‚° λ„κµ¬λ“¤μ„ κ°€μ§€κ³  μλ” **μ κ³µμ(Provider)**μ…λ‹λ‹¤.
2.  **Client (MathTutor)**: μ‚¬μ©μμ™€ λ€ν™”ν•λ©°, μν•™ λ¬Έμ κ°€ λ‚μ¤λ©΄ Serverμ—κ² μ„μ„ν•λ” **μ†λΉ„μ(Consumer)**μ…λ‹λ‹¤.

---

## π’» μ½”λ“ μƒμ„Έ λ¶„μ„ 1: μ„λ²„ (Server)

μ„λ²„ μ½”λ“λ” "μν•™ λ„κµ¬ μƒμ"μ…λ‹λ‹¤. μ›Ή μ„λ²„ ν•νƒλ΅ μ‹¤ν–‰λμ–΄ μ™Έλ¶€μ μ”μ²­μ„ κΈ°λ‹¤λ¦½λ‹λ‹¤.

### 1. λ‹¤μ–‘ν• λ„κµ¬(Tools) κµ¬ν„
```go
// 1. μ†μ νλ³„
func checkPrime(ctx tool.Context, args struct{ Num int }) (string, error) { ... }

// 2. ν©ν† λ¦¬μ–Ό κ³„μ‚° (Factorial)
func calculateFactorial(ctx tool.Context, args struct{ N int }) (string, error) { ... }

// 3. μµλ€κ³µμ•½μ (GCD)
func calculateGCD(ctx tool.Context, args struct{ A, B int }) (string, error) { ... }
```
*   κ° ν•¨μλ” μμ Go λ΅μ§μΌλ΅ μ‘μ„±λμ—μµλ‹λ‹¤.
*   `functiontool.New`λ¥Ό ν†µν•΄ ADK λ„κµ¬λ΅ λ“±λ΅λ©λ‹λ‹¤.

### 2. μ›Ή λ°μ² λ° A2A μ„¤μ • β­
μΌλ° `Launcher` λ€μ‹  `web.Launcher`λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

```go
	// A2A ν†µμ‹ μ„ μ§€μ›ν•λ” μ›Ή λ°μ² μƒμ„±
	webLauncher := web.NewLauncher(a2a.NewLauncher())

	// ν¬νΈ λ° URL μ„¤μ •
	// μ΄ μ„¤μ •μ€ "λ‚λ” localhost:8001μ— μκ³ , λ‚΄ λ¥λ ¥μ€ μ—¬κΈ°μ„ ν™•μΈν•  μ μμ–΄"λΌκ³  μ•λ¦¬λ” μ—­ν• μ…λ‹λ‹¤.
	webLauncher.Parse([]string{
		"--port", "8001",
		"a2a",
		"--a2a_agent_url", "http://localhost:8001",
	})
    
    // μ‹¤ν–‰
    webLauncher.Run(ctx, config)
```
*   **`a2a.NewLauncher()`**: μ΄ μ—μ΄μ „νΈκ°€ **Agent Card**(μμ‹ μ μ΄λ¦„, μ„¤λ…, λ„κµ¬ λ©λ΅μ΄ μ ν λ…ν•¨)λ¥Ό JSON ν•νƒλ΅ μ κ³µν•λ„λ΅ λ§λ“­λ‹λ‹¤.
*   μ„λ²„κ°€ μ‹¤ν–‰λλ©΄ λΈλΌμ°μ €μ—μ„ `http://localhost:8001`λ΅ μ ‘μ†ν•μ—¬ μ΄ μ—μ΄μ „νΈμ μ •λ³΄λ¥Ό λ³Ό μ μμµλ‹λ‹¤.

---

## π’» μ½”λ“ μƒμ„Έ λ¶„μ„ 2: ν΄λΌμ΄μ–ΈνΈ (Client)

ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μ„λ²„μ μ΅΄μ¬λ¥Ό μ•κ³ , ν•„μ”ν•  λ• νΈμ¶ν•λ” "λ©”μΈ μ—μ΄μ „νΈ"μ…λ‹λ‹¤.

### 1. μ›κ²© μ—μ΄μ „νΈ μ—°κ²° (Connecting to Remote)
```go
	// μ›κ²© μ—μ΄μ „νΈ μ •μ
	remoteMathAgent, err := remoteagent.NewA2A(remoteagent.A2AConfig{
		Name: "RemoteMathHelper",
		// [μ¤‘μ”] Descriptionμ€ λ©”μΈ λ¨λΈμ΄ "μ΄ μ‘μ—…μ„ λ„κµ¬μ—κ² μ‹ν‚¬κΉ?" νλ‹¨ν•λ” κΈ°μ¤€μ΄ λ©λ‹λ‹¤.
		Description:     "Can check prime numbers, calculate factorials, and find GCD of two numbers.",
		
        // μ„λ²„μ μ£Όμ† (Agent Cardλ¥Ό κ°€μ Έμ¬ μ„μΉ)
        AgentCardSource: "http://localhost:8001", 
	})
```
*   **`AgentCardSource`**: ν΄λΌμ΄μ–ΈνΈλ” μ‹μ‘ν•  λ• μ΄ μ£Όμ†λ΅ μ”μ²­μ„ λ³΄λ‚΄ μ„λ²„κ°€ μ–΄λ–¤ λ„κµ¬λ¥Ό κ°€μ§€κ³  μλ”μ§€, μ…μ¶λ ¥ μ¤ν‚¤λ§λ” λ¬΄μ—‡μΈμ§€ μλ™μΌλ΅ νμ•…(Handshake)ν•©λ‹λ‹¤.

### 2. μ„λΈ μ—μ΄μ „νΈλ΅ λ“±λ΅
```go
	mathTutor, _ := llmagent.New(llmagent.Config{
		Name:  "MathTutor",
		// ...
		Instruction: "You are a math tutor. If ... delegate the task to the RemoteMathHelper.",
        // λ΅μ»¬ ν•¨μ λ€μ‹ , μ›κ²© μ—μ΄μ „νΈ κ°μ²΄λ¥Ό ν†µμ§Έλ΅ SubAgentsμ— λ“±λ΅ν•©λ‹λ‹¤.
		SubAgents: []agent.Agent{remoteMathAgent},
	})
```
*   μ΄μ  `MathTutor`λ” μ–΄λ ¤μ΄ μν•™ μ§λ¬Έμ„ λ°›μΌλ©΄, μ¤μ¤λ΅ ν•΄κ²°ν•λ ¤ ν•μ§€ μ•κ³  `RemoteMathHelper`μ—κ² API μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.

---

## π€ μ‹¤ν–‰ λ°©λ²• (How to Run)

μ΄ μμ λ” λ‘ κ°μ ν„°λ―Έλ„ μ°½μ΄ ν•„μ”ν•©λ‹λ‹¤.

### Step 1. μ„λ²„ μ‹¤ν–‰ (Terminal 1)
λ¨Όμ € μν•™ λ„κµ¬λ¥Ό κ°€μ§„ μ„λ²„λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
```bash
# μ„λ²„ μ½”λ“κ°€ μλ” ν΄λ”λ΅ μ΄λ™ ν›„
go run server/main.go
```
*   *μ¶λ ¥:* `Starting Prime Server on port 8001...`

### Step 2. ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰ (Terminal 2)
μ„λ²„κ°€ μΌμ§„ μƒνƒμ—μ„, μ‚¬μ©μμ™€ λ€ν™”ν•  ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
```bash
# ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ μλ” ν΄λ”λ΅ μ΄λ™ ν›„
go run client/main.go chat
```

### Step 3. λ€ν™” ν…μ¤νΈ
μ΄μ  ν΄λΌμ΄μ–ΈνΈ ν„°λ―Έλ„μ—μ„ μ§λ¬Έν•΄ λ΄…λ‹λ‹¤.

**Q1. ν©ν† λ¦¬μ–Ό κ³„μ‚°**
```text
User: 5μ ν©ν† λ¦¬μ–Όμ€ λ­μ•Ό?
(λ‚΄λ¶€ λ™μ‘: Client -> HTTP Req -> Server(CalculateFactorial) -> Result -> Client)
Bot: 5μ ν©ν† λ¦¬μ–Όμ€ 120μ…λ‹λ‹¤.
```

**Q2. μµλ€κ³µμ•½μ κ³„μ‚°**
```text
User: 12μ™€ 18μ μµλ€κ³µμ•½μ κµ¬ν•΄μ¤.
Bot: 12μ™€ 18μ μµλ€κ³µμ•½μλ” 6μ…λ‹λ‹¤.
```

**Q3. λ³µν•© μ§λ¬Έ**
```text
User: 7μ΄ μ†μμΈμ§€ ν™•μΈν•΄λ³΄κ³ , λ§λ‹¤λ©΄ 7μ ν©ν† λ¦¬μ–Όλ„ κµ¬ν•΄μ¤.
Bot: 7μ€ μ†μκ°€ λ§μµλ‹λ‹¤. κ·Έλ¦¬κ³  7μ ν©ν† λ¦¬μ–Όμ€ 5040μ…λ‹λ‹¤.
```

---

## π” μ™ μ΄ λ°©μ‹μ΄ μ¤‘μ”ν•κ°€μ”?

1.  **λ§μ΄ν¬λ΅μ„λΉ„μ¤ (Microservices)**: κ±°λ€ν• ν•λ‚μ AI λ€μ‹ , 'κ²€μƒ‰ λ‹΄λ‹Ή', 'κ³„μ‚° λ‹΄λ‹Ή', 'DB λ‹΄λ‹Ή' μ—μ΄μ „νΈλ¥Ό λ”°λ΅ λ§λ“¤μ–΄ μ μ§€λ³΄μν•  μ μμµλ‹λ‹¤.
2.  **λ³΄μ• (Security)**: `Server` μ½μ—λ§ DB λΉ„λ°€λ²νΈλ‚ μ¤‘μ” λ΅μ§μ„ μ¨κ²¨λ‘κ³ , `Client`μ—λ” κΈ°λ¥λ§ λ…Έμ¶ν•  μ μμµλ‹λ‹¤.
3.  **μ–Έμ–΄ λ…λ¦½μ„±**: ADKμ A2A ν”„λ΅ν† μ½μ€ ν‘μ¤€ μ›Ή ν†µμ‹ μ„ μ‚¬μ©ν•λ―€λ΅, λ‚μ¤‘μ—λ” PythonμΌλ΅ μ§  μ—μ΄μ „νΈμ™€ Goλ΅ μ§  μ—μ΄μ „νΈκ°€ λ€ν™”ν•  μλ„ μμµλ‹λ‹¤.

---
μκ³ ν•μ…¨μµλ‹λ‹¤! π“
μ΄κ²ƒμΌλ΅ ADK ν•Έμ¦μ¨μ λ¨λ“  κ³Όμ •μ„ λ§μ³¤μµλ‹λ‹¤. μ—¬λ¬λ¶„μ€ μ΄μ  **λ¨λΈ μ—°λ™**, **λ„κµ¬ μ μ‘**, **κΈ°μ–µ κ΄€λ¦¬**, **μ›ν¬ν”λ΅μ°**, κ·Έλ¦¬κ³  **λ¶„μ‚° μ—μ΄μ „νΈ μ‹μ¤ν…**κΉμ§€ κµ¬μ¶•ν•  μ μλ” λ¥λ ¥μ„ κ°–μ¶”κ² λμ—μµλ‹λ‹¤.

μ΄μ  μ—¬λ¬λ¶„λ§μ λ©‹μ§„ AI μ„λΉ„μ¤λ¥Ό λ§λ“¤μ–΄ λ³΄μ„Έμ”! π€